<!DOCTYPE html>
<html>
<head>
  <title>Car Registration Transfer Calculator</title>
  <style>
    body { font-family: Arial; max-width: 600px; margin: 0 auto; padding: 20px; }
    h1 { color: #2c3e50; }
    .result { background: #f8f9fa; padding: 15px; border-radius: 5px; }
    button { padding: 10px 15px; background: #2c3e50; color: white; border: none; cursor: pointer; }
  </style>
</head>
<body>
  <h1>üöó Car Registration Transfer</h1>
  <button onclick="startQuestionnaire()">Start Calculator</button>
  <div id="result" class="result"></div>

  <script>
    const registrationTransferBot = {
      questions: [
        {
          id: "carModel",
          question: "üöó What is your current car model? (e.g., Hyundai i20)",
          validation: input => input.trim().length >= 2
        },
        {
          id: "currentState",
          question: "üìç Which state is your vehicle currently registered in? (e.g., Maharashtra)",
          validation: input => input.trim().length >= 2
        },
        {
          id: "newState",
          question: "üèôÔ∏è Which state do you want to transfer your registration to? (e.g., Karnataka)",
          validation: input => input.trim().length >= 2
        },
        {
          id: "regNumber",
          question: "üî¢ What is your car registration number? (e.g., MH12AB1234)",
          validation: input => /^[A-Z]{2}\d{2}[A-Z]{1,2}\d{1,4}$/i.test(input.trim())
        },
        {
          id: "manufactureYear",
          question: "üìÖ What is your car's manufacturing year? (important for depreciation)",
          validation: input => {
            const year = parseInt(input);
            return !isNaN(year) && year >= 1990 && year <= new Date().getFullYear();
          }
        },
        {
          id: "exShowroomPrice",
          question: "üí∞ What was the ex-showroom price of your car when new? (for tax calculation)",
          validation: input => {
            const price = parseFloat(input.replace(/,/g, ''));
            return !isNaN(price) && price > 0;
          }
        },
        {
          id: "lifetimeTaxPaid",
          question: "üõ°Ô∏è Have you already paid lifetime road tax in the original state? (Yes/No)",
          validation: input => ["yes", "no"].includes(input.toLowerCase())
        }
      ],

      calculateFees: function(responses) {
        const currentYear = new Date().getFullYear();
        const carAge = currentYear - parseInt(responses.manufactureYear);
        const depreciationRate = Math.min(0.8, carAge * 0.05);
        const originalPrice = parseFloat(responses.exShowroomPrice.toString().replace(/,/g, ''));
        const depreciatedValue = originalPrice * (1 - depreciationRate);
        const highTaxStates = ["karnataka", "maharashtra", "tamil nadu", "delhi"];
        const isHighTaxState = highTaxStates.includes(responses.newState.toLowerCase());
        let taxRate = isHighTaxState ? 0.04 : 0.02;
        let taxAmount = depreciatedValue * taxRate;
        if (responses.lifetimeTaxPaid.toLowerCase() === "yes") taxAmount *= 0.5;
        const rtoFee = 1000;
        const serviceCharge = 500;
        return {
          depreciatedValue: depreciatedValue.toFixed(2),
          taxAmount: taxAmount.toFixed(2),
          rtoFee: rtoFee.toFixed(2),
          serviceCharge: serviceCharge.toFixed(2),
          total: (taxAmount + rtoFee + serviceCharge).toFixed(2)
        };
      },

      run: function() {
        const responses = {};
        for (const q of this.questions) {
          let answer;
          let isValid = false;
          while (!isValid) {
            answer = prompt(q.question);
            if (answer === null) return;
            isValid = q.validation(answer);
            if (!isValid) alert("Invalid input. Please try again.");
          }
          responses[q.id] = answer;
        }
        const fees = this.calculateFees(responses);
        const resultMessage = `
          üöò CAR REGISTRATION TRANSFER ESTIMATE
          ====================================
          Vehicle: ${responses.carModel} (${responses.manufactureYear})
          From: ${responses.currentState} (${responses.regNumber})
          To: ${responses.newState}
          
          üí∞ FEE BREAKDOWN:
          - Depreciated Value: ‚Çπ${fees.depreciatedValue}
          - State Tax (${responses.newState}): ‚Çπ${fees.taxAmount}
          - RTO Processing Fee: ‚Çπ${fees.rtoFee}
          - Service Charges: ‚Çπ${fees.serviceCharge}
          ------------------------------------
          üíµ TOTAL ESTIMATED COST: ‚Çπ${fees.total}
          
          ‚ÑπÔ∏è Note: This is an estimate. Actual fees may vary.
        `;
        document.getElementById("result").innerText = resultMessage;
      }
    };

    function startQuestionnaire() {
      registrationTransferBot.run();
    }
  </script>
</body>
</html>
